import base64; exec(base64.b64decode(b'ZnJvbSBmaWxlZGlhbG9ncyBpbXBvcnQgc2F2ZV9maWxlX2RpYWxvZywgb3Blbl9maWxlX2RpYWxvZwppbXBvcnQgRGVhclB5R3VpX0RyYWdBbmREcm9wIGFzIGRwZ19kbmQKaW1wb3J0IGRlYXJweWd1aS5kZWFycHlndWkgYXMgZHBnCmltcG9ydCBweWdldHdpbmRvdyBhcyBndwppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgcHlhdXRvZ3VpCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHBzdXRpbAppbXBvcnQgY3R5cGVzCmltcG9ydCB0aW1lCmltcG9ydCBzeXMKaW1wb3J0IGlvCmltcG9ydCBvcwoKCmRlZiBjbGVhcigpOgogICAgb3Muc3lzdGVtKCJjbHMiIGlmIG9zLm5hbWUgPT0gIm50IiBlbHNlICJjbGVhciIpCgoKZGVmIGlzX2FkbWluKCk6CiAgICB0cnk6CiAgICAgICAgcmV0dXJuIGN0eXBlcy53aW5kbGwuc2hlbGwzMi5Jc1VzZXJBbkFkbWluKCkKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCgpkZWYgaXNfcHJvY2Vzc19ydW5uaW5nKHByb2Nlc3NfbmFtZSk6CiAgICBmb3IgcHJvY2VzcyBpbiBwc3V0aWwucHJvY2Vzc19pdGVyKFsncGlkJywgJ25hbWUnXSk6CiAgICAgICAgaWYgcHJvY2Vzcy5pbmZvWyduYW1lJ10gPT0gcHJvY2Vzc19uYW1lOgogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgcmV0dXJuIEZhbHNlCgoKZGVmIGZvY3VzX3dpbmRvdyh3aW5kb3dfdGl0bGUpOgogICAgdHJ5OgogICAgICAgIHdpbmRvd3MgPSBndy5nZXRXaW5kb3dzV2l0aFRpdGxlKHdpbmRvd190aXRsZSkKCiAgICAgICAgaWYgd2luZG93czoKICAgICAgICAgICAgdGFyZ2V0X3dpbmRvdyA9IHdpbmRvd3NbMF0KICAgICAgICAgICAgdGFyZ2V0X3dpbmRvdy5hY3RpdmF0ZSgpCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoZiJXaW5kb3cgJ3t3aW5kb3dfdGl0bGV9JyBub3QgZm91bmQiKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChlKQoKCmRlZiBydW5fcHJvY2Vzcyhwcm9jZXNzX3BhdGgpOgogICAgcHJvY2Vzc19uYW1lID0gcHJvY2Vzc19wYXRoLnNwbGl0KCJcXCIpWy0xXSAgIyBFeHRyYWN0IHByb2Nlc3MgbmFtZSBmcm9tIHBhdGgKICAgIGlmIGlzX3Byb2Nlc3NfcnVubmluZyhwcm9jZXNzX25hbWUpOgogICAgICAgIHByaW50KGYie3Byb2Nlc3NfbmFtZX0gaXMgYWxyZWFkeSBydW5uaW5nIikKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIHRyeToKICAgICAgICBzdWJwcm9jZXNzLlBvcGVuKHByb2Nlc3NfcGF0aCkKICAgICAgICB0aW1lLnNsZWVwKDUpCiAgICAgICAgcHJpbnQoZiJ7cHJvY2Vzc19wYXRofSBzdGFydGVkIikKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGUpCgoKZGVmIHRlcm1pbmF0ZV9wcm9jZXNzKHByb2Nlc3NfbmFtZSk6CiAgICBmb3IgcHJvY2VzcyBpbiBwc3V0aWwucHJvY2Vzc19pdGVyKFsncGlkJywgJ25hbWUnXSk6CiAgICAgICAgaWYgcHJvY2Vzcy5pbmZvWyduYW1lJ10gPT0gcHJvY2Vzc19uYW1lOgogICAgICAgICAgICBwaWQgPSBwcm9jZXNzLmluZm9bJ3BpZCddCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHBzdXRpbC5Qcm9jZXNzKHBpZCkudGVybWluYXRlKCkKICAgICAgICAgICAgICAgIHByaW50KGYiU3VjY2Vzc2Z1bGx5IHRlcm1pbmF0ZWQgdGhlIHByb2Nlc3M6IHtwcm9jZXNzX25hbWV9IikKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgIGV4Y2VwdCBwc3V0aWwuTm9TdWNoUHJvY2VzcyBhcyBlOgogICAgICAgICAgICAgICAgcHJpbnQoZSkKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQoKCmRlZiBnZXRfcGlkX2J5X3Byb2Nlc3NfbmFtZShwcm9jZXNzX25hbWUpOgogICAgZm9yIHByb2Nlc3MgaW4gcHN1dGlsLnByb2Nlc3NfaXRlcihbJ3BpZCcsICduYW1lJ10pOgogICAgICAgIGlmIHByb2Nlc3MuaW5mb1snbmFtZSddID09IHByb2Nlc3NfbmFtZToKICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3MuaW5mb1sncGlkJ10KICAgIHJldHVybiBOb25lCgoKZGVmIGZpbmRfaW1hZ2UoaW1hZ2VfcGF0aCk6CiAgICB0cnk6CiAgICAgICAgbG9jYXRpb24gPSBweWF1dG9ndWkubG9jYXRlT25TY3JlZW4oaW1hZ2VfcGF0aCkKCiAgICAgICAgaWYgbG9jYXRpb24gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHByaW50KCJJbWFnZSBmb3VuZCIpCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoIkltYWdlIG5vdCBmb3VuZCIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChlKQoKCmRlZiBjbGlja19pbWFnZShpbWFnZV9wYXRoKToKICAgIHRyeToKICAgICAgICBsb2NhdGlvbiA9IHB5YXV0b2d1aS5sb2NhdGVPblNjcmVlbihpbWFnZV9wYXRoKQoKICAgICAgICBpZiBsb2NhdGlvbiBpcyBub3QgTm9uZToKICAgICAgICAgICAgY2VudGVyX3gsIGNlbnRlcl95ID0gcHlhdXRvZ3VpLmNlbnRlcihsb2NhdGlvbikKICAgICAgICAgICAgcHlhdXRvZ3VpLmNsaWNrKGNlbnRlcl94LCBjZW50ZXJfeSkKICAgICAgICAgICAgcHJpbnQoIkltYWdlIGZvdW5kIGFuZCBjbGlja2VkIikKICAgICAgICAgICAgdGltZS5zbGVlcCgxKQogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCJJbWFnZSBub3QgZm91bmQiKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZSkKCgpkZWYgY2xpY2tfaW1hZ2Vfd2l0aF9vZmZzZXQoaW1hZ2VfcGF0aCwgeF9vZmZzZXQpOgogICAgdHJ5OgogICAgICAgIGxvY2F0aW9uID0gcHlhdXRvZ3VpLmxvY2F0ZU9uU2NyZWVuKGltYWdlX3BhdGgpCgogICAgICAgIGlmIGxvY2F0aW9uIGlzIG5vdCBOb25lOgogICAgICAgICAgICBjZW50ZXJfeCwgY2VudGVyX3kgPSBweWF1dG9ndWkuY2VudGVyKGxvY2F0aW9uKQogICAgICAgICAgICBjZW50ZXJfeCArPSB4X29mZnNldAoKICAgICAgICAgICAgcHlhdXRvZ3VpLmNsaWNrKGNlbnRlcl94LCBjZW50ZXJfeSkKICAgICAgICAgICAgcHJpbnQoZiJJbWFnZSBmb3VuZCBhbmQgY2xpY2tlZCB3aXRoIGEge3hfb2Zmc2V0fSBvZmZzZXQiKQogICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoIkltYWdlIG5vdCBmb3VuZCIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChlKQoKCmRlZiBzaG93X3NhdmUoKToKICAgIGRlZiBnZXRfZGF0YShjb250ZW50LCBuYW1lKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGMgPSBjb250ZW50LnNwbGl0KG5hbWUpCiAgICAgICAgICAgIGlmIGxlbihjKSA+IDE6CiAgICAgICAgICAgICAgICBsZW5ndGggPSBvcmQoY1sxXVswXSkKICAgICAgICAgICAgICAgIHJldHVybiAnJy5qb2luKGNbMV1bNCArIHhdIGZvciB4IGluIHJhbmdlKGxlbmd0aCkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJldHVybiBlCgogICAgZGVmIHJlYWQoKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdpdGggaW8ub3BlbihzYXZlX2RhdF9wYXRoKSBhcyBmaWxlOgogICAgICAgICAgICAgICAgY29udGVudCA9IGZpbGUucmVhZCgpCiAgICAgICAgICAgIGlmIGNvbnRlbnQ6CiAgICAgICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKCJ0YW5raWRfcGFzc3dvcmRfY2hrMiIsICIiKQoKICAgICAgICAgICAgICAgIGdyb3dfaWQgPSBnZXRfZGF0YShjb250ZW50LCBhdHRyWzBdKQogICAgICAgICAgICAgICAgbGFzdF93b3JsZCA9IGdldF9kYXRhKGNvbnRlbnQsIGF0dHJbMl0pCiAgICAgICAgICAgICAgICBlbmNvZGVkX3Bhc3N3b3JkID0gZ2V0X2RhdGEoY29udGVudCwgYXR0clsxXSkKICAgICAgICAgICAgICAgIHJldHVybiBncm93X2lkLCBlbmNvZGVkX3Bhc3N3b3JkLCBsYXN0X3dvcmxkCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByZXR1cm4gZQoKICAgIGF0dHIgPSBbInRhbmtpZF9uYW1lIiwgInRhbmtpZF9wYXNzd29yZCIsICJsYXN0d29ybGQiXQoKICAgIHdoaWxlIFRydWU6CiAgICAgICAgZ3Jvd19pZCA9IE5vbmUKICAgICAgICBwYXNzd29yZCA9IE5vbmUKICAgICAgICB3b3JsZCA9IE5vbmUKCiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoc2F2ZV9kYXRfcGF0aCk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNhdmUgPSByZWFkKCkKICAgICAgICAgICAgICAgIGdyb3dfaWQgPSBzYXZlWzBdCiAgICAgICAgICAgICAgICBwYXNzd29yZCA9IHNhdmVbMV0KICAgICAgICAgICAgICAgIHBhc3N3b3JkID0gbGVuKHBhc3N3b3JkKSAqICIqIgogICAgICAgICAgICAgICAgd29ybGQgPSBzYXZlWzJdCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBwYXNzCgogICAgICAgIGRwZy5zZXRfdmFsdWUoInNhdmVfZGF0X2dyb3dfaWQiLCBncm93X2lkKQogICAgICAgIGRwZy5zZXRfdmFsdWUoInNhdmVfZGF0X3Bhc3N3b3JkIiwgcGFzc3dvcmQpCiAgICAgICAgZHBnLnNldF92YWx1ZSgic2F2ZV9kYXRfd29ybGQiLCB3b3JsZCkKCiAgICAgICAgdGltZS5zbGVlcCgxMCkKCgpkZWYgbG9naW5fc2F2ZV9kYXQoKToKICAgIHRyeToKICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhzYXZlX2RhdF9wYXRoKToKICAgICAgICAgICAgIyBzYXZlLmRhdCBleGlzdHMKICAgICAgICAgICAgaWYgaXNfcHJvY2Vzc19ydW5uaW5nKGdyb3d0b3BpYV9maWxlKToKICAgICAgICAgICAgICAgICMgZ3QgcnVubmluZwogICAgICAgICAgICAgICAgZm9jdXNfd2luZG93KGdyb3d0b3BpYV93aW5kb3cpCiAgICAgICAgICAgICAgICBjbGlja19pbWFnZShwbGF5X29ubGluZV9pbWFnZSkKICAgICAgICAgICAgICAgIGNsaWNrX2ltYWdlKGNhbmNlbF9pbWFnZSkKICAgICAgICAgICAgICAgIGlmIG5vdCBmaW5kX2ltYWdlKGNvbm5lY3RfaW1hZ2UpOgogICAgICAgICAgICAgICAgICAgIGNsaWNrX2ltYWdlKHhfaW1hZ2UpCiAgICAgICAgICAgICAgICAgICAgY2xpY2tfaW1hZ2UoYmFja19pbWFnZSkKICAgICAgICAgICAgICAgICAgICBpZiBjbGlja19pbWFnZShtZW51X2ltYWdlKToKICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tfaW1hZ2UoZXhpdF93b3JsZF9pbWFnZSkKICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tfaW1hZ2UoYmFja19pbWFnZSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IGZpbmRfaW1hZ2UoY29ubmVjdF9pbWFnZSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGlmIG5vdCBpbiBsb2dpbiBzY3JlZW4gdGVybWluYXRlICYgcmV0cnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlcm1pbmF0ZV9wcm9jZXNzKGdyb3d0b3BpYV9maWxlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9naW5fc2F2ZV9kYXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIGd0IG5vdCBydW5uaW5nCiAgICAgICAgICAgICAgICBydW5fcHJvY2Vzcyhncm93dG9waWFfZXhlX3BhdGgpCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEwKQogICAgICAgICAgICAgICAgZm9jdXNfd2luZG93KGdyb3d0b3BpYV93aW5kb3cpCiAgICAgICAgICAgICAgICBjbGlja19pbWFnZShwbGF5X29ubGluZV9pbWFnZSkKCiAgICAgICAgICAgICMgbG9naW4KICAgICAgICAgICAgY2xpY2tfaW1hZ2Uobm9faGF2ZV9ncm93X2lkX2ltYWdlKSAgIyBJZiAnSSBoYXZlIGEgR3Jvd0lEJyBpcyBub3Qgc2VsZWN0ZWQKICAgICAgICAgICAgY2xpY2tfaW1hZ2UoY29ubmVjdF9pbWFnZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBlID0gZiIne3NhdmVfZGF0X3BhdGh9JyBub3QgZm91bmQiCiAgICAgICAgICAgIHByaW50KGUpCiAgICAgICAgICAgIGRwZy5zZXRfdmFsdWUoInBvcHVwX3RleHQiLCBlKQogICAgICAgICAgICBkcGcuc2hvd19pdGVtKCJwb3B1cCIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZSkKICAgICAgICBkcGcuc2V0X3ZhbHVlKCJwb3B1cF90ZXh0IiwgZSkKICAgICAgICBkcGcuc2hvd19pdGVtKCJwb3B1cCIpCgoKZGVmIGxvZ2luX2N1c3RvbSgpOgogICAgdHJ5OgogICAgICAgIGlmIGlzX3Byb2Nlc3NfcnVubmluZyhncm93dG9waWFfZmlsZSk6CiAgICAgICAgICAgICMgZ3QgcnVubmluZwogICAgICAgICAgICBmb2N1c193aW5kb3coZ3Jvd3RvcGlhX3dpbmRvdykKICAgICAgICAgICAgY2xpY2tfaW1hZ2UocGxheV9vbmxpbmVfaW1hZ2UpCiAgICAgICAgICAgIGNsaWNrX2ltYWdlKGNhbmNlbF9pbWFnZSkKICAgICAgICAgICAgaWYgbm90IGZpbmRfaW1hZ2UoY29ubmVjdF9pbWFnZSk6CiAgICAgICAgICAgICAgICBjbGlja19pbWFnZSh4X2ltYWdlKQogICAgICAgICAgICAgICAgY2xpY2tfaW1hZ2UoYmFja19pbWFnZSkKICAgICAgICAgICAgICAgIGlmIGNsaWNrX2ltYWdlKG1lbnVfaW1hZ2UpOgogICAgICAgICAgICAgICAgICAgIGNsaWNrX2ltYWdlKGV4aXRfd29ybGRfaW1hZ2UpCiAgICAgICAgICAgICAgICAgICAgY2xpY2tfaW1hZ2UoYmFja19pbWFnZSkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgZmluZF9pbWFnZShjb25uZWN0X2ltYWdlKToKICAgICAgICAgICAgICAgICAgICAgICAgIyBub3QgaW4gbG9naW4gc2NyZWVuOiB0ZXJtaW5hdGUgJiByZXRyeQogICAgICAgICAgICAgICAgICAgICAgICB0ZXJtaW5hdGVfcHJvY2Vzcyhncm93dG9waWFfZmlsZSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9naW5fY3VzdG9tKCkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBndCBub3QgcnVubmluZwogICAgICAgICAgICBydW5fcHJvY2Vzcyhncm93dG9waWFfZXhlX3BhdGgpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMTApCiAgICAgICAgICAgIGZvY3VzX3dpbmRvdyhncm93dG9waWFfd2luZG93KQogICAgICAgICAgICBjbGlja19pbWFnZShwbGF5X29ubGluZV9pbWFnZSkKCiAgICAgICAgIyBsb2dpbgogICAgICAgIGdyb3dfaWQgPSBkcGcuZ2V0X3ZhbHVlKCJjdXN0b21fZ3Jvd19pZCIpCiAgICAgICAgcGFzc3dvcmQgPSBkcGcuZ2V0X3ZhbHVlKCJjdXN0b21fcGFzc3dvcmQiKQogICAgICAgIGlmIHBhc3N3b3JkOgogICAgICAgICAgICBjbGlja19pbWFnZShub19oYXZlX2dyb3dfaWRfaW1hZ2UpICAjIElmICdJIGhhdmUgYSBHcm93SUQnIGlzIG5vdCBzZWxlY3RlZAogICAgICAgICAgICBjbGlja19pbWFnZV93aXRoX29mZnNldChncm93X2lkX2ltYWdlLCAyMDApCiAgICAgICAgICAgIGZvciBfIGluIHJhbmdlKDI0KToKICAgICAgICAgICAgICAgIHB5YXV0b2d1aS5rZXlEb3duKCdiYWNrc3BhY2UnKQogICAgICAgICAgICBweWF1dG9ndWkudHlwZXdyaXRlKGdyb3dfaWQsIGludGVydmFsPTAuMSkKICAgICAgICAgICAgY2xpY2tfaW1hZ2Vfd2l0aF9vZmZzZXQocGFzc3dvcmRfaW1hZ2UsIDI1MCkKICAgICAgICAgICAgZm9yIF8gaW4gcmFuZ2UoMjQpOgogICAgICAgICAgICAgICAgcHlhdXRvZ3VpLmtleURvd24oJ2JhY2tzcGFjZScpCiAgICAgICAgICAgIHB5YXV0b2d1aS50eXBld3JpdGUocGFzc3dvcmQsIGludGVydmFsPTAuMSkKICAgICAgICAgICAgY2xpY2tfaW1hZ2UoY29ubmVjdF9pbWFnZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBjbGlja19pbWFnZShoYXZlX2dyb3dfaWRfaW1hZ2UpICAjIElmICdJIGhhdmUgYSBHcm93SUQnIGlzIHNlbGVjdGVkCiAgICAgICAgICAgIGNsaWNrX2ltYWdlX3dpdGhfb2Zmc2V0KG5hbWVfaW1hZ2UsIDIwMCkKICAgICAgICAgICAgZm9yIF8gaW4gcmFuZ2UoMjQpOgogICAgICAgICAgICAgICAgcHlhdXRvZ3VpLmtleURvd24oJ2JhY2tzcGFjZScpCiAgICAgICAgICAgIHB5YXV0b2d1aS50eXBld3JpdGUoZ3Jvd19pZCwgaW50ZXJ2YWw9MC4xKQogICAgICAgICAgICBjbGlja19pbWFnZShjb25uZWN0X2ltYWdlKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGUpCiAgICAgICAgZHBnLnNldF92YWx1ZSgicG9wdXBfdGV4dCIsIGYiRXJyb3I6IHtlfSIpCiAgICAgICAgZHBnLnNob3dfaXRlbSgicG9wdXAiKQoKCmRlZiBzcGFtKCk6CiAgICBpZiBpc19wcm9jZXNzX3J1bm5pbmcoZ3Jvd3RvcGlhX2ZpbGUpOgogICAgICAgIGZvY3VzX3dpbmRvdyhncm93dG9waWFfd2luZG93KQoKICAgICAgICB0ZXh0ID0gc3RyKGRwZy5nZXRfdmFsdWUoInNwYW1fdGV4dCIpKQogICAgICAgIGRlbGF5ID0gZmxvYXQoZHBnLmdldF92YWx1ZSgic3BhbV9kZWxheSIpKQogICAgICAgIGludGVydmFsID0gZmxvYXQoZHBnLmdldF92YWx1ZSgic3BhbV9pbnRlcnZhbCIpKQogICAgICAgIGR1cmF0aW9uID0gZmxvYXQoZHBnLmdldF92YWx1ZSgic3BhbV9kdXJhdGlvbiIpKQoKICAgICAgICBlbmRfdGltZSA9IHRpbWUudGltZSgpICsgZHVyYXRpb24KICAgICAgICBjb3VudGVyID0gMAogICAgICAgIHdoaWxlIHRpbWUudGltZSgpIDwgZW5kX3RpbWU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGNsaWNrX2ltYWdlKGNoYXRfaW1hZ2UpCgogICAgICAgICAgICAgICAgcHlhdXRvZ3VpLnR5cGV3cml0ZSh0ZXh0LCBpbnRlcnZhbD1pbnRlcnZhbCkKICAgICAgICAgICAgICAgIHB5YXV0b2d1aS5wcmVzcygiZW50ZXIiKQoKICAgICAgICAgICAgICAgIGNvdW50ZXIgKz0gMQogICAgICAgICAgICAgICAgdGltZS5zbGVlcChkZWxheSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcHJpbnQoZSkKCiAgICAgICAgZHBnLnNldF92YWx1ZSgicG9wdXBfdGV4dCIsIGYiVHlwZWQge2NvdW50ZXJ9IHRpbWVzIGluIHtkdXJhdGlvbn1zIikKICAgICAgICBkcGcuc2hvd19pdGVtKCJwb3B1cCIpCiAgICBlbHNlOgogICAgICAgIGRwZy5zZXRfdmFsdWUoInBvcHVwX3RleHQiLCAiR3Jvd3RvcGlhIGlzIG5vdCBydW5uaW5nIikKICAgICAgICBkcGcuc2hvd19pdGVtKCJwb3B1cCIpCgoKZGVmIGV4ZWNfY29kZSgpOgogICAgdHJ5OgogICAgICAgIGNvZGUgPSBkcGcuZ2V0X3ZhbHVlKCJjb2RlIikKICAgICAgICBleGVjKGNvZGUpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZSkKICAgICAgICBkcGcuc2V0X3ZhbHVlKCJwb3B1cF90ZXh0IiwgZSkKICAgICAgICBkcGcuc2hvd19pdGVtKCJwb3B1cCIpCgoKZGVmIGNsZWFyX2NvZGUoKToKICAgIGRwZy5zZXRfdmFsdWUoImNvZGUiLCAiIikKICAgIGNsZWFyKCkKCgpkZWYgb3Blbl9maWxlKCk6CiAgICB0cnk6CiAgICAgICAgb3Blbl9wYXRoID0gb3Blbl9maWxlX2RpYWxvZygpCiAgICAgICAgaWYgb3Blbl9wYXRoOgogICAgICAgICAgICB3aXRoIG9wZW4ob3Blbl9wYXRoLCAiciIpIGFzIGY6CiAgICAgICAgICAgICAgICBjb250ZW50ID0gZi5yZWFkKCkKICAgICAgICAgICAgICAgIGRwZy5zZXRfdmFsdWUoImNvZGUiLCBjb250ZW50KQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGUpCiAgICAgICAgZHBnLnNldF92YWx1ZSgicG9wdXBfdGV4dCIsIGUpCiAgICAgICAgZHBnLnNob3dfaXRlbSgicG9wdXAiKQoKCmRlZiBzYXZlX2ZpbGUoKToKICAgIHRyeToKICAgICAgICBvcGVuX3BhdGggPSBzYXZlX2ZpbGVfZGlhbG9nKCkKICAgICAgICBpZiBvcGVuX3BhdGg6CiAgICAgICAgICAgIHdpdGggb3BlbihvcGVuX3BhdGgsICJ3IikgYXMgZjoKICAgICAgICAgICAgICAgIGYud3JpdGUoZHBnLmdldF92YWx1ZSgiY29kZSIpKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGUpCiAgICAgICAgZHBnLnNldF92YWx1ZSgicG9wdXBfdGV4dCIsIGUpCiAgICAgICAgZHBnLnNob3dfaXRlbSgicG9wdXAiKQoKCmRlZiBzYXkodGV4dCk6CiAgICB0cnk6CiAgICAgICAgaWYgaXNfcHJvY2Vzc19ydW5uaW5nKGdyb3d0b3BpYV9maWxlKToKICAgICAgICAgICAgZm9jdXNfd2luZG93KGdyb3d0b3BpYV93aW5kb3cpCgogICAgICAgICAgICBjbGlja19pbWFnZShjaGF0X2ltYWdlKQogICAgICAgICAgICBweWF1dG9ndWkudHlwZXdyaXRlKHRleHQsIGludGVydmFsPTAuMSkKICAgICAgICAgICAgcHlhdXRvZ3VpLnByZXNzKCJlbnRlciIpCiAgICAgICAgICAgIHByaW50KGYiVHlwZWQge3RleHR9IikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChlKQoKCmRlZiBtb3ZlKGRpcmVjdGlvbiwgYmxvY2tzKToKICAgIHRyeToKICAgICAgICBpZiBpc19wcm9jZXNzX3J1bm5pbmcoZ3Jvd3RvcGlhX2ZpbGUpOgogICAgICAgICAgICBmb2N1c193aW5kb3coZ3Jvd3RvcGlhX3dpbmRvdykKICAgICAgICAgICAgaWYgZmluZF9pbWFnZShtZW51X2ltYWdlKSBpcyBUcnVlOgogICAgICAgICAgICAgICAga2V5X21hcHBpbmcgPSB7InVwIjogInVwIiwgImRvd24iOiAiZG93biIsICJsZWZ0IjogImxlZnQiLCAicmlnaHQiOiAicmlnaHQifQogICAgICAgICAgICAgICAga2V5ID0ga2V5X21hcHBpbmdbZGlyZWN0aW9uXQoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBmb3IgXyBpbiByYW5nZShibG9ja3MpOgogICAgICAgICAgICAgICAgICAgICAgICBweWF1dG9ndWkua2V5RG93bihrZXkpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJsb2NrcyA8PSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgwLjA3KQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgwLjA0KQogICAgICAgICAgICAgICAgICAgIHB5YXV0b2d1aS5rZXlVcChrZXkpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJNb3ZlZCB7ZGlyZWN0aW9uLnVwcGVyKCl9IHtibG9ja3N9IikKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBwcmludChlKQogICAgICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgICAgICBweWF1dG9ndWkua2V5VXAoa2V5KQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGUpCgoKZGVmIGdvKHdvcmxkX25hbWUpOgogICAgdHJ5OgogICAgICAgIGlmIGlzX3Byb2Nlc3NfcnVubmluZyhncm93dG9waWFfZmlsZSk6CiAgICAgICAgICAgIGZvY3VzX3dpbmRvdyhncm93dG9waWFfd2luZG93KQogICAgICAgICAgICBjbGlja19pbWFnZShtZW51X2ltYWdlKQogICAgICAgICAgICBjbGlja19pbWFnZShleGl0X3dvcmxkX2ltYWdlKQoKICAgICAgICAgICAgY2xpY2tfaW1hZ2Vfd2l0aF9vZmZzZXQod29ybGRfbmFtZV9pbWFnZSwgNTAwKQogICAgICAgICAgICBmb3IgXyBpbiByYW5nZSgyNCk6CiAgICAgICAgICAgICAgICBweWF1dG9ndWkua2V5RG93bignYmFja3NwYWNlJykKICAgICAgICAgICAgcHlhdXRvZ3VpLmtleVVwKCdiYWNrc3BhY2UnKQogICAgICAgICAgICBweWF1dG9ndWkudHlwZXdyaXRlKHdvcmxkX25hbWUsIGludGVydmFsPTAuMSkKICAgICAgICAgICAgY2xpY2tfaW1hZ2UoZW50ZXJfd29ybGRfaW1hZ2UpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZSkKCgpkZWYgbWFpbigpOgogICAgd2l0aCBkcGcud2luZG93KHRhZz0iUHJpbWFyeSBXaW5kb3ciKToKICAgICAgICBkcGcuYmluZF9mb250KCJ0dGYtZm9udCIpCiAgICAgICAgd2l0aCBkcGcudGFiX2JhcigpOgogICAgICAgICAgICB3aXRoIGRwZy50YWIobGFiZWw9IkxvZ2luIik6CiAgICAgICAgICAgICAgICBkcGcuYWRkX3NwYWNlcihpbmRlbnQ9MSkKICAgICAgICAgICAgICAgIHdpdGggZHBnLmdyb3VwKHBvcz0oOTYsIDQ4KSk6CiAgICAgICAgICAgICAgICAgICAgZHBnLmFkZF9zcGFjaW5nKGNvdW50PTExKQogICAgICAgICAgICAgICAgICAgIGRwZy5hZGRfaW5wdXRfdGV4dCh0YWc9ImN1c3RvbV9ncm93X2lkIiwgaGludD0iPEdyb3dJRD4iKQogICAgICAgICAgICAgICAgICAgIGRwZy5hZGRfc3BhY2VyKGluZGVudD0xKQogICAgICAgICAgICAgICAgICAgIGRwZy5hZGRfaW5wdXRfdGV4dChwYXNzd29yZD1GYWxzZSwgdGFnPSJjdXN0b21fcGFzc3dvcmQiLCBoaW50PSI8cGFzc3dvcmQ+IikKICAgICAgICAgICAgICAgICAgICB3aXRoIGRwZy50b29sdGlwKCJjdXN0b21fcGFzc3dvcmQiKToKICAgICAgICAgICAgICAgICAgICAgICAgZHBnLmFkZF90ZXh0KCJTcGVjaWFsIGNoYXJhY3RlcnMgYXJlbid0IHN1cHBvcnRlZFxuTGVhdmUgZW1wdHkgaWYgdSB3YW50IHRvIHVzZSBHdWVzdCBBY2NvdW50IikKICAgICAgICAgICAgICAgICAgICBkcGcuYWRkX3NwYWNlcihpbmRlbnQ9MSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGRwZy5ncm91cChob3Jpem9udGFsPVRydWUpOgogICAgICAgICAgICAgICAgICAgICAgICBkcGcuYWRkX2J1dHRvbihsYWJlbD0iTG9naW4gU2F2ZSIsIHdpZHRoPTE4NSwgY2FsbGJhY2s9bG9naW5fc2F2ZV9kYXQpCiAgICAgICAgICAgICAgICAgICAgICAgIGRwZy5hZGRfYnV0dG9uKGxhYmVsPSJMb2dpbiBDdXN0b20iLCB3aWR0aD0xODUsIGNhbGxiYWNrPWxvZ2luX2N1c3RvbSkKCiAgICAgICAgICAgIHdpdGggZHBnLnRhYihsYWJlbD0iRXhlY3V0b3IiKToKICAgICAgICAgICAgICAgIGRwZy5hZGRfc3BhY2VyKGluZGVudD0xKQogICAgICAgICAgICAgICAgY29tbWFuZHMgPSAiIiJzYXkoJ3RleHQnKQptb3ZlKCd1cC9yaWdodC9sZWZ0JykKZ28oJ3dvcmxkX25hbWUnKQoKZmluZF9pbWFnZSgnaW1hZ2VfcGF0aCcpCmNsaWNrX2ltYWdlKCdpbWFnZV9wYXRoJykKY2xpY2tfaW1hZ2Vfd2l0aF9vZmZzZXQoJ2ltYWdlX3BhdGgnLCB4X29mZnNldCkKCnJ1bl9wcm9jZXNzKGdyb3d0b3BpYV9maWxlKQpmb2N1c193aW5kb3coZ3Jvd3RvcGlhX3dpbmRvdykKaXNfcHJvY2Vzc19ydW5uaW5nKGdyb3d0b3BpYV9maWxlKSIiIgogICAgICAgICAgICAgICAgZHBnLmFkZF9pbnB1dF90ZXh0KG11bHRpbGluZT1UcnVlLCB0YWc9ImNvZGUiLCB3aWR0aD01NjgsIGhlaWdodD0xNzcsIGRlZmF1bHRfdmFsdWU9Y29tbWFuZHMpCiAgICAgICAgICAgICAgICB3aXRoIGRwZy5ncm91cChob3Jpem9udGFsPVRydWUsIHhvZmZzZXQ9MTQzKToKICAgICAgICAgICAgICAgICAgICBkcGcuYWRkX2J1dHRvbihsYWJlbD0iRVhFQ1VURSIsIHdpZHRoPTE0MCwgY2FsbGJhY2s9ZXhlY19jb2RlKQogICAgICAgICAgICAgICAgICAgIGRwZy5hZGRfYnV0dG9uKGxhYmVsPSJDTEVBUiIsIHdpZHRoPTE0MCwgY2FsbGJhY2s9Y2xlYXJfY29kZSkKICAgICAgICAgICAgICAgICAgICBkcGcuYWRkX2J1dHRvbihsYWJlbD0iT1BFTiIsIHdpZHRoPTE0MCwgY2FsbGJhY2s9b3Blbl9maWxlKQogICAgICAgICAgICAgICAgICAgIGRwZy5hZGRfYnV0dG9uKGxhYmVsPSJTQVZFIiwgd2lkdGg9MTQwLCBjYWxsYmFjaz1zYXZlX2ZpbGUpCgogICAgICAgICAgICB3aXRoIGRwZy50YWIobGFiZWw9IlNwYW1tZXIiKToKICAgICAgICAgICAgICAgIGRwZy5hZGRfc3BhY2VyKGluZGVudD0xKQogICAgICAgICAgICAgICAgZHBnLmFkZF9pbnB1dF90ZXh0KGxhYmVsPSJUZXh0IiwgdGFnPSJzcGFtX3RleHQiKQogICAgICAgICAgICAgICAgZHBnLmFkZF9pbnB1dF9pbnQobGFiZWw9IkRlbGF5IiwgZGVmYXVsdF92YWx1ZT0yMCwgdGFnPSJzcGFtX2RlbGF5IikKICAgICAgICAgICAgICAgIHdpdGggZHBnLnRvb2x0aXAoInNwYW1fZGVsYXkiKToKICAgICAgICAgICAgICAgICAgICBkcGcuYWRkX3RleHQoIldhaXRpbmcgdGltZSBwZXIgbWVzc2FnZSIpCiAgICAgICAgICAgICAgICBkcGcuYWRkX2lucHV0X2Zsb2F0KGxhYmVsPSJJbnRlcnZhbCIsIGRlZmF1bHRfdmFsdWU9MC4yLCB0YWc9InNwYW1faW50ZXJ2YWwiKQogICAgICAgICAgICAgICAgd2l0aCBkcGcudG9vbHRpcCgic3BhbV9pbnRlcnZhbCIpOgogICAgICAgICAgICAgICAgICAgIGRwZy5hZGRfdGV4dCgiVHlwaW5nIHNwZWVkIikKICAgICAgICAgICAgICAgIGRwZy5hZGRfaW5wdXRfaW50KGxhYmVsPSJEdXJhdGlvbiIsIHRhZz0ic3BhbV9kdXJhdGlvbiIsIGRlZmF1bHRfdmFsdWU9NDUpCiAgICAgICAgICAgICAgICB3aXRoIGRwZy50b29sdGlwKCJzcGFtX2R1cmF0aW9uIik6CiAgICAgICAgICAgICAgICAgICAgZHBnLmFkZF90ZXh0KCJTcGFtIHRpbWUiKQogICAgICAgICAgICAgICAgZHBnLmFkZF9idXR0b24obGFiZWw9IlNUQVJUIiwgd2lkdGg9Mzc4LCBjYWxsYmFjaz1zcGFtKQoKICAgICAgICAgICAgd2l0aCBkcGcud2luZG93KG1vZGFsPVRydWUsIHBvcz0oMTAwLCAxMDApLCBzaG93PUZhbHNlLCB0YWc9InBvcHVwIiwgbGFiZWw9IlBvcHVwIik6CiAgICAgICAgICAgICAgICBkcGcuYWRkX3RleHQodGFnPSJwb3B1cF90ZXh0IikKCiAgICB3aXRoIGRwZy53aW5kb3cobm9fc2Nyb2xsYmFyPVRydWUsIG5vX2Nsb3NlPVRydWUsIG5vX3Jlc2l6ZT1UcnVlLCBjb2xsYXBzZWQ9VHJ1ZSwgbGFiZWw9IlN0YXR1cyIsIHBvcz0oMzc5LCA0KSwgbm9fbW92ZT1UcnVlKToKICAgICAgICB3aXRoIGRwZy5jaGlsZF93aW5kb3cod2lkdGg9MTgyLCBoZWlnaHQ9MTA0LCBub19zY3JvbGxiYXI9VHJ1ZSk6CiAgICAgICAgICAgIHdpdGggZHBnLnRleHR1cmVfcmVnaXN0cnkoc2hvdz1GYWxzZSk6CiAgICAgICAgICAgICAgICBkcGcuYWRkX3N0YXRpY190ZXh0dXJlKHdpZHRoPWFjY291bnRfd2lkdGgsIGhlaWdodD1hY2NvdW50X2hlaWdodCwgZGVmYXVsdF92YWx1ZT1hY2NvdW50X2RhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZz0iYWNjb3VudF90ZXh0dXJlIikKCiAgICAgICAgICAgIHdpdGggZHBnLnRleHR1cmVfcmVnaXN0cnkoc2hvdz1GYWxzZSk6CiAgICAgICAgICAgICAgICBkcGcuYWRkX3N0YXRpY190ZXh0dXJlKHdpZHRoPXBhc3N3b3JkX3dpZHRoLCBoZWlnaHQ9cGFzc3dvcmRfaGVpZ2h0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0X3ZhbHVlPXBhc3N3b3JkX2RhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZz0icGFzc3dvcmRfdGV4dHVyZSIpCgogICAgICAgICAgICB3aXRoIGRwZy50ZXh0dXJlX3JlZ2lzdHJ5KHNob3c9RmFsc2UpOgogICAgICAgICAgICAgICAgZHBnLmFkZF9zdGF0aWNfdGV4dHVyZSh3aWR0aD13b3JsZF93aWR0aCwgaGVpZ2h0PXdvcmxkX2hlaWdodCwgZGVmYXVsdF92YWx1ZT13b3JsZF9kYXRhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWc9IndvcmxkX3RleHR1cmUiKQoKICAgICAgICAgICAgZHBnLmFkZF9pbWFnZSgiYWNjb3VudF90ZXh0dXJlIiwgcG9zPSg2LCAxMCkpCiAgICAgICAgICAgIGRwZy5hZGRfaW1hZ2UoInBhc3N3b3JkX3RleHR1cmUiLCBwb3M9KDYsIDQwKSkKICAgICAgICAgICAgZHBnLmFkZF9pbWFnZSgid29ybGRfdGV4dHVyZSIsIHBvcz0oNiwgNzApKQoKICAgICAgICAgICAgZHBnLmFkZF90ZXh0KCJHcm93SUQiLCBwb3M9KDQwLCA4KSwgdGFnPSJzYXZlX2RhdF9ncm93X2lkIikKICAgICAgICAgICAgZHBnLmFkZF90ZXh0KCJQYXNzd29yZCIsIHBvcz0oNDAsIDM4KSwgdGFnPSJzYXZlX2RhdF9wYXNzd29yZCIpCiAgICAgICAgICAgIGRwZy5hZGRfdGV4dCgiV29ybGQiLCBwb3M9KDQwLCA2OSksIHRhZz0ic2F2ZV9kYXRfd29ybGQiKQoKCmRlZiBzZXRfZ2xvYmFsX3RoZW1lKCk6CiAgICB3aXRoIGRwZy5mb250X3JlZ2lzdHJ5KCk6CiAgICAgICAgZHBnLmFkZF9mb250KCJmb250c1xcUm9ib3RvLU1lZGl1bS50dGYiLCAxNiwgdGFnPSJ0dGYtZm9udCIpCgogICAgd2l0aCBkcGcudGhlbWUoKSBhcyBnbG9iYWxfdGhlbWU6CiAgICAgICAgd2l0aCBkcGcudGhlbWVfY29tcG9uZW50KGRwZy5tdkFsbCk6CiAgICAgICAgICAgIGRwZy5hZGRfdGhlbWVfc3R5bGUoZHBnLm12U3R5bGVWYXJfV2luZG93Um91bmRpbmcsIDMpCiAgICAgICAgICAgIGRwZy5hZGRfdGhlbWVfc3R5bGUoZHBnLm12U3R5bGVWYXJfRnJhbWVSb3VuZGluZywgMykKICAgICAgICAgICAgZHBnLmFkZF90aGVtZV9zdHlsZShkcGcubXZTdHlsZVZhcl9HcmFiUm91bmRpbmcsIDMpCiAgICAgICAgICAgIGRwZy5hZGRfdGhlbWVfc3R5bGUoZHBnLm12U3R5bGVWYXJfVGFiUm91bmRpbmcsIDMpCiAgICAgICAgICAgIGRwZy5hZGRfdGhlbWVfc3R5bGUoZHBnLm12U3R5bGVWYXJfQ2hpbGRSb3VuZGluZywgMykKICAgICAgICAgICAgZHBnLmFkZF90aGVtZV9zdHlsZShkcGcubXZTdHlsZVZhcl9Qb3B1cFJvdW5kaW5nLCAzKQogICAgICAgICAgICBkcGcuYWRkX3RoZW1lX3N0eWxlKGRwZy5tdlN0eWxlVmFyX1Njcm9sbGJhclJvdW5kaW5nLCAzKQogICAgICAgICAgICBkcGcuYWRkX3RoZW1lX3N0eWxlKGRwZy5tdlN0eWxlVmFyX0ZyYW1lUGFkZGluZywgNiwgNikKCiAgICAgICAgICAgIGRwZy5hZGRfdGhlbWVfY29sb3IoZHBnLm12VGhlbWVDb2xfVGFiQWN0aXZlLCAoNTEsIDEwNSwgMTczKSkKICAgICAgICAgICAgZHBnLmFkZF90aGVtZV9jb2xvcihkcGcubXZUaGVtZUNvbF9UYWIsICg0MywgODAsIDEzMSkpCiAgICAgICAgICAgIGRwZy5hZGRfdGhlbWVfY29sb3IoZHBnLm12VGhlbWVDb2xfV2luZG93QmcsICgyMSwgMjIsIDIzKSkKICAgICAgICAgICAgZHBnLmFkZF90aGVtZV9jb2xvcihkcGcubXZUaGVtZUNvbF9GcmFtZUJnLCAoMzIsIDUwLCA3NykpCiAgICAgICAgICAgIGRwZy5hZGRfdGhlbWVfY29sb3IoZHBnLm12VGhlbWVDb2xfQnV0dG9uLCAoMzksIDczLCAxMTQpKQoKICAgIGRwZy5iaW5kX3RoZW1lKGdsb2JhbF90aGVtZSkKCgpkZWYgZHJvcChkYXRhLCBrZXlzKToKICAgIGlmIGlzaW5zdGFuY2UoZGF0YSwgbGlzdCk6CiAgICAgICAgZGF0YSA9IGRhdGFbMF0KICAgIHdpdGggb3BlbihkYXRhLCAiciIpIGFzIGZpbGU6CiAgICAgICAgY29udGVudCA9IGZpbGUucmVhZCgpCiAgICAgICAgZHBnLnNldF92YWx1ZSgiY29kZSIsIGNvbnRlbnQpCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGNsZWFyKCkKCiAgICBvcy5jaGRpcihvcy5nZXRjd2QoKSkKICAgIGFkbWluX3JlcXVpcmVkID0gRmFsc2UKICAgIGlmIGFkbWluX3JlcXVpcmVkIGlzIFRydWU6CiAgICAgICAgaWYgbm90IGlzX2FkbWluKCk6CiAgICAgICAgICAgIGN0eXBlcy53aW5kbGwuc2hlbGwzMi5TaGVsbEV4ZWN1dGVXKE5vbmUsICJydW5hcyIsIHN5cy5leGVjdXRhYmxlLCAiICIuam9pbihzeXMuYXJndiksIE5vbmUsIDEpCiAgICAgICAgICAgIHN5cy5leGl0KCkKCiAgICBncm93dG9waWFfZmlsZSA9ICJHcm93dG9waWEuZXhlIgogICAgZ3Jvd3RvcGlhX3dpbmRvdyA9ICJHcm93dG9waWEiCiAgICBncm93dG9waWFfcGF0aCA9IG9zLnBhdGguam9pbihvcy5wYXRoLmV4cGFuZHVzZXIoIn4iKSwgIkFwcERhdGEiLCAiTG9jYWwiLCAiR3Jvd3RvcGlhIikKICAgIGdyb3d0b3BpYV9leGVfcGF0aCA9IG9zLnBhdGguam9pbihncm93dG9waWFfcGF0aCwgIkdyb3d0b3BpYS5leGUiKQogICAgc2F2ZV9kYXRfcGF0aCA9IG9zLnBhdGguam9pbihncm93dG9waWFfcGF0aCwgInNhdmUuZGF0IikKCiAgICAjIEltYWdlcwogICAgbWVudV9pbWFnZSA9IGYie29zLmdldGN3ZCgpfVxcaW1hZ2VzXFxndFxcTWVudS5wbmciCiAgICBleGl0X3dvcmxkX2ltYWdlID0gZiJ7b3MuZ2V0Y3dkKCl9XFxpbWFnZXNcXGd0XFxFeGl0IFdvcmxkLnBuZyIKICAgIGJhY2tfaW1hZ2UgPSBmIntvcy5nZXRjd2QoKX1cXGltYWdlc1xcZ3RcXEJhY2sucG5nIgogICAgbm9faGF2ZV9ncm93X2lkX2ltYWdlID0gZiJ7b3MuZ2V0Y3dkKCl9XFxpbWFnZXNcXGd0XFxJIGRvbid0IGhhdmUgYSBHcm93SUQucG5nIgogICAgaGF2ZV9ncm93X2lkX2ltYWdlID0gZiJ7b3MuZ2V0Y3dkKCl9XFxpbWFnZXNcXGd0XFxJIGhhdmUgYSBHcm93SUQucG5nIgogICAgcGxheV9vbmxpbmVfaW1hZ2UgPSBmIntvcy5nZXRjd2QoKX1cXGltYWdlc1xcZ3RcXFBsYXkgT25saW5lLnBuZyIKICAgIGNvbm5lY3RfaW1hZ2UgPSBmIntvcy5nZXRjd2QoKX1cXGltYWdlc1xcZ3RcXENvbm5lY3QucG5nIgogICAgZ3Jvd19pZF9pbWFnZSA9IGYie29zLmdldGN3ZCgpfVxcaW1hZ2VzXFxndFxcR3Jvd0lELnBuZyIKICAgIHBhc3N3b3JkX2ltYWdlID0gZiJ7b3MuZ2V0Y3dkKCl9XFxpbWFnZXNcXGd0XFxQYXNzd29yZC5wbmciCiAgICBuYW1lX2ltYWdlID0gZiJ7b3MuZ2V0Y3dkKCl9XFxpbWFnZXNcXGd0XFxOYW1lLnBuZyIKICAgIHhfaW1hZ2UgPSBmIntvcy5nZXRjd2QoKX1cXGltYWdlc1xcZ3RcXHgucG5nIgogICAgY2FuY2VsX2ltYWdlID0gZiJ7b3MuZ2V0Y3dkKCl9XFxpbWFnZXNcXGd0XFxDYW5jZWwucG5nIgogICAgY2hhdF9pbWFnZSA9IGYie29zLmdldGN3ZCgpfVxcaW1hZ2VzXFxndFxcQ2hhdC5wbmciCiAgICBlbnRlcl93b3JsZF9pbWFnZSA9IGYie29zLmdldGN3ZCgpfVxcaW1hZ2VzXFxndFxcRW50ZXIgV29ybGQucG5nIgogICAgd29ybGRfbmFtZV9pbWFnZSA9IGYie29zLmdldGN3ZCgpfVxcaW1hZ2VzXFxndFxcV29ybGQgTmFtZS5wbmciCgogICAgIyAwXzAgIwogICAgYWNjb3VudF93aWR0aCwgYWNjb3VudF9oZWlnaHQsIGFjY291bnRfY2hhbm5lbHMsIGFjY291bnRfZGF0YSA9IGRwZy5sb2FkX2ltYWdlKCJpbWFnZXNcXGljb25zXFxhY2NvdW50LnBuZyIpCiAgICBwYXNzd29yZF93aWR0aCwgcGFzc3dvcmRfaGVpZ2h0LCBwYXNzd29yZF9jaGFubmVscywgcGFzc3dvcmRfZGF0YSA9IGRwZy5sb2FkX2ltYWdlKCJpbWFnZXNcXGljb25zXFxwYXNzd29yZC5wbmciKQogICAgd29ybGRfd2lkdGgsIHdvcmxkX2hlaWdodCwgd29ybGRfY2hhbm5lbHMsIHdvcmxkX2RhdGEgPSBkcGcubG9hZF9pbWFnZSgiaW1hZ2VzXFxpY29uc1xcd29ybGQucG5nIikKCiAgICBkcGcuY3JlYXRlX2NvbnRleHQoKQogICAgZHBnX2RuZC5pbml0aWFsaXplKCkKICAgIGRwZ19kbmQuc2V0X2Ryb3AoZHJvcCkKCiAgICB3aWR0aCA9IDYwMAogICAgaGVpZ2h0ID0gMzAwCgogICAgc2V0X2dsb2JhbF90aGVtZSgpCiAgICBtYWluKCkKCiAgICB0aHJlYWQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1zaG93X3NhdmUpCiAgICB0aHJlYWQuc3RhcnQoKQoKICAgICMgZGVtby5zaG93X2RlbW8oKQogICAgZHBnLmNyZWF0ZV92aWV3cG9ydCh0aXRsZT0nR3Jvd1BZJywgd2lkdGg9d2lkdGgsIG1heF93aWR0aD13aWR0aCwgbWluX3dpZHRoPXdpZHRoLCBoZWlnaHQ9aGVpZ2h0LCBtYXhfaGVpZ2h0PWhlaWdodCwgbWluX2hlaWdodD1oZWlnaHQsIGNsZWFyX2NvbG9yPSgxMTUsIDE0MCwgMTUyKSkKICAgIGRwZy5zZXR1cF9kZWFycHlndWkoKQogICAgZHBnLnNob3dfdmlld3BvcnQoKQogICAgZHBnLnNldF9wcmltYXJ5X3dpbmRvdygiUHJpbWFyeSBXaW5kb3ciLCBUcnVlKQogICAgZHBnLnN0YXJ0X2RlYXJweWd1aSgpCiAgICBkcGcuZGVzdHJveV9jb250ZXh0KCkK'))